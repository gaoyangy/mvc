<!DOCTYPE html>
<meta charset="utf-8" />
<title>im</title>
<script src="./lib/socket.io.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="./css/style.css">

<body>
    <div id="messagelist" style="width:500px;height:300px">

    </div>
    <div>
        <textarea name="" id="msg" cols="50" rows="5"></textarea>
        <button id="sendBtn">发送</button>
    </div>
</body>
<script>
    var socket = io.connect('127.0.0.1:3000'), //与服务器进行连接
        button = document.getElementById('sendBtn'),
        inputData = document.getElementById('msg'),
        messagelist = document.getElementById('messagelist');
    socket.on('connect', function () {
        let userInfo = JSON.parse(localStorage.getItem('userInfo'));
        socket.send(userInfo);
    socket.on('message', function (msg) {
      // my msg
    });
    button.onclick = function() {
        let userInfo = JSON.parse(localStorage.getItem('userInfo'));
        userInfo.message = inputData.value
        socket.emit('foo', userInfo); //发送一个名为foo的事件，并且传递一个字符串数据‘hello’
    }
    socket.on('msg', function(data) {
        var msglist = document.createElement("p");
        msglist.innerHTML = data.userInfo.user_name + '说：' + data.userInfo.message
        messagelist.appendChild(msglist)
    })
    })
</script>

</html>